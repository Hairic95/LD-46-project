[gd_scene load_steps=26 format=2]

[ext_resource path="res://Textures/wood.png" type="Texture" id=1]
[ext_resource path="res://Src/Entities/Campfire.tscn" type="PackedScene" id=2]
[ext_resource path="res://Src/Entities/Character.tscn" type="PackedScene" id=3]
[ext_resource path="res://Src/Scenes/GameScene.gd" type="Script" id=4]
[ext_resource path="res://Src/Scenes/bg_behind_tree.tscn" type="PackedScene" id=5]
[ext_resource path="res://Textures/bg_ground.png" type="Texture" id=6]
[ext_resource path="res://Textures/bg_mountains_and_far_trees.png" type="Texture" id=7]
[ext_resource path="res://Textures/bg_sky.png" type="Texture" id=8]
[ext_resource path="res://Textures/bg_tree_2.png" type="Texture" id=9]
[ext_resource path="res://Textures/bg_tree_3.png" type="Texture" id=10]
[ext_resource path="res://Textures/bg_tree_1.png" type="Texture" id=11]
[ext_resource path="res://Src/Scenes/tree_shake.gd" type="Script" id=12]
[ext_resource path="res://Src/Scenes/SMOKE.tscn" type="PackedScene" id=13]
[ext_resource path="res://Fonts/HWYGOTH.TTF" type="DynamicFontData" id=14]
[ext_resource path="res://Music/gameplay_music_loop.wav" type="AudioStream" id=15]

[sub_resource type="Shader" id=11]
code = "shader_type canvas_item;

void fragment() {
	COLOR = texture(TEXTURE, UV) * vec4(vec3(sin(TIME * 0.25) + 3.0) * 0.3, 1.0);
}"

[sub_resource type="ShaderMaterial" id=12]
shader = SubResource( 11 )

[sub_resource type="Animation" id=1]
resource_name = "shake"
length = 4.0
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath(".:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 2, 4 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ Vector2( 101.651, 249.397 ), Vector2( 111.623, 249.397 ), Vector2( 101.651, 249.397 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath(".:rotation_degrees")
tracks/1/interp = 2
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0, 2, 4 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ -2.75223, 1.74626, -2.75223 ]
}

[sub_resource type="Animation" id=2]
resource_name = "shake"
length = 4.0
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 2, 4 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ Vector2( 514.371, 243.537 ), Vector2( 509.202, 243.537 ), Vector2( 514.371, 243.537 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath(".:rotation_degrees")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0, 2, 4 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ 2.80328, -1.62661, 2.80328 ]
}

[sub_resource type="Animation" id=3]
resource_name = "shake"
length = 4.0
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 2, 4 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ Vector2( 869.354, 233.779 ), Vector2( 880.985, 235.072 ), Vector2( 869.354, 233.779 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath(".:rotation_degrees")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0, 2, 4 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ -3.8321, 2.38664, -3.8321 ]
}

[sub_resource type="RectangleShape2D" id=4]
extents = Vector2( 456, 120 )

[sub_resource type="GDScript" id=14]
script/source = "extends Area2D

var wood_amount = 2
var add_pending = false

func _process(delta):
	if $collect_sprite.global_position.distance_to(global_position) < 1.0:
		$collect_sprite.visible = false

		if add_pending:
			for i in range(3):
				get_node(\"wood_\" + str(i)).visible = false
			for i in range(clamp(wood_amount, 0, 3)):
				get_node(\"wood_\" + str(i)).visible = true
			$Label.text = str(wood_amount)
			$AnimationPlayer.play(\"show_amount\")
			add_pending = false

func _ready():
	GLOBALS.connect(\"on_collect_wood\", self, \"on_collect_wood\")
	
func on_collect_wood(character, amount):
	wood_amount += amount
	add_pending = true
	$collect_sprite.global_position = character.global_position
	$collect_sprite.visible = true
	$Tween.interpolate_property($collect_sprite, \"global_position\", $collect_sprite.global_position, global_position, 2.0, Tween.TRANS_LINEAR, Tween.EASE_IN)
	$Tween.start()
"

[sub_resource type="RectangleShape2D" id=13]
extents = Vector2( 52, 66 )

[sub_resource type="Animation" id=15]
resource_name = "show_amount"
tracks/0/type = "value"
tracks/0/path = NodePath("Label:modulate")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 0.4, 0.9, 1 ),
"transitions": PoolRealArray( 1, 1, 1, 1 ),
"update": 0,
"values": [ Color( 1, 1, 1, 0 ), Color( 1, 1, 1, 1 ), Color( 1, 1, 1, 1 ), Color( 1, 1, 1, 0 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("Label:rect_position")
tracks/1/interp = 2
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0, 0.4, 0.9, 1 ),
"transitions": PoolRealArray( 1, 1, 1, 1 ),
"update": 0,
"values": [ Vector2( -32.5802, -76.3064 ), Vector2( -30.8655, -122.605 ), Vector2( -30.8655, -122.605 ), Vector2( -29.1508, -96.8834 ) ]
}

[sub_resource type="DynamicFont" id=16]
size = 50
outline_size = 3
outline_color = Color( 0, 0, 0, 1 )
font_data = ExtResource( 14 )

[node name="GameScene" type="Node2D"]
script = ExtResource( 4 )

[node name="Background" type="Node2D" parent="."]

[node name="bg_sky" type="Sprite" parent="Background"]
material = SubResource( 12 )
position = Vector2( 513.264, 304.478 )
scale = Vector2( 0.309766, 0.297761 )
texture = ExtResource( 8 )

[node name="bg_mountains_and_far_trees" type="Sprite" parent="Background"]
position = Vector2( 516.457, 305.503 )
scale = Vector2( 0.309766, 0.297761 )
texture = ExtResource( 7 )

[node name="bg_behind_tree" parent="Background" instance=ExtResource( 5 )]
position = Vector2( 65.374, 259.28 )

[node name="bg_behind_tree2" parent="Background" instance=ExtResource( 5 )]
position = Vector2( 138.504, 260.388 )

[node name="bg_behind_tree3" parent="Background" instance=ExtResource( 5 )]
position = Vector2( 251.524, 268.144 )

[node name="bg_behind_tree4" parent="Background" instance=ExtResource( 5 )]
position = Vector2( 376.731, 250.416 )

[node name="bg_behind_tree5" parent="Background" instance=ExtResource( 5 )]
position = Vector2( 560.665, 216.067 )

[node name="bg_behind_tree6" parent="Background" instance=ExtResource( 5 )]
position = Vector2( 679.224, 257.064 )

[node name="bg_behind_tree7" parent="Background" instance=ExtResource( 5 )]
position = Vector2( 763.435, 254.848 )

[node name="bg_behind_tree8" parent="Background" instance=ExtResource( 5 )]
position = Vector2( 846.538, 247.092 )

[node name="bg_behind_tree9" parent="Background" instance=ExtResource( 5 )]
position = Vector2( 992.798, 254.848 )

[node name="SMOKE" parent="Background" instance=ExtResource( 13 )]

[node name="bg_tree_1" type="Sprite" parent="Background"]
position = Vector2( 101.651, 249.397 )
rotation = -0.0480355
scale = Vector2( 0.301222, 0.301222 )
texture = ExtResource( 11 )
script = ExtResource( 12 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="Background/bg_tree_1"]
anims/shake = SubResource( 1 )

[node name="bg_tree_3" type="Sprite" parent="Background"]
position = Vector2( 514.371, 243.537 )
rotation = 0.0489265
scale = Vector2( 0.301222, 0.301222 )
texture = ExtResource( 10 )
script = ExtResource( 12 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="Background/bg_tree_3"]
anims/shake = SubResource( 2 )

[node name="bg_tree_2" type="Sprite" parent="Background"]
position = Vector2( 869.354, 233.779 )
rotation = -0.0668828
scale = Vector2( 0.301222, 0.301222 )
texture = ExtResource( 9 )
script = ExtResource( 12 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="Background/bg_tree_2"]
anims/shake = SubResource( 3 )

[node name="bg_ground" type="Sprite" parent="."]
position = Vector2( 512.012, 305.503 )
scale = Vector2( 0.31243, 0.297761 )
texture = ExtResource( 6 )

[node name="Campfire" parent="." instance=ExtResource( 2 )]
position = Vector2( 472, 528 )
scale = Vector2( 0.3, 0.3 )

[node name="Characters" type="Node2D" parent="."]

[node name="Pos1" type="Position2D" parent="Characters"]
position = Vector2( 128, 464 )

[node name="Character" parent="Characters/Pos1" instance=ExtResource( 3 )]
scale = Vector2( -0.25, 0.25 )

[node name="Pos2" type="Position2D" parent="Characters"]
position = Vector2( 288, 456 )

[node name="Character" parent="Characters/Pos2" instance=ExtResource( 3 )]
scale = Vector2( -0.25, 0.25 )
character_name = "Roxie"

[node name="Pos3" type="Position2D" parent="Characters"]
position = Vector2( 656, 456 )

[node name="Character" parent="Characters/Pos3" instance=ExtResource( 3 )]
scale = Vector2( 0.25, 0.25 )
character_name = "Tatiana"

[node name="Pos4" type="Position2D" parent="Characters"]
position = Vector2( 824, 464 )

[node name="Character" parent="Characters/Pos4" instance=ExtResource( 3 )]
position = Vector2( 13.2781, -8.85217 )
scale = Vector2( 0.25, 0.25 )
character_name = "Gio"

[node name="Area2D" type="Area2D" parent="." groups=[
"Forest",
]]

[node name="CollisionShape2D" type="CollisionShape2D" parent="Area2D"]
visible = false
position = Vector2( 488, 144 )
shape = SubResource( 4 )

[node name="WOOD" type="Area2D" parent="."]
position = Vector2( 962.529, 530.514 )
script = SubResource( 14 )

[node name="collect_sprite" type="Sprite" parent="WOOD"]
visible = false
modulate = Color( 1, 0, 0, 1 )
position = Vector2( -4.45313, 4.69675 )
rotation = 0.352447
scale = Vector2( 0.182713, 0.201312 )
texture = ExtResource( 1 )

[node name="wood_2" type="Sprite" parent="WOOD"]
visible = false
position = Vector2( -7.26892, -13.1417 )
rotation = -0.946066
scale = Vector2( 0.187848, 0.196529 )
texture = ExtResource( 1 )

[node name="wood_0" type="Sprite" parent="WOOD"]
position = Vector2( -3.40045, 6.80194 )
rotation = 0.352447
scale = Vector2( 0.182713, 0.201312 )
texture = ExtResource( 1 )

[node name="wood_1" type="Sprite" parent="WOOD"]
position = Vector2( -8.04346, 3.70679 )
rotation = -0.359947
scale = Vector2( 0.182713, 0.201312 )
texture = ExtResource( 1 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="WOOD"]
position = Vector2( 0, -26 )
shape = SubResource( 13 )

[node name="Tween" type="Tween" parent="WOOD"]

[node name="AnimationPlayer" type="AnimationPlayer" parent="WOOD"]
anims/show_amount = SubResource( 15 )

[node name="Label" type="Label" parent="WOOD"]
modulate = Color( 1, 1, 1, 0 )
margin_left = -32.5802
margin_top = -76.3064
margin_right = 8.4198
margin_bottom = 40.6936
custom_fonts/font = SubResource( 16 )
text = "1"
__meta__ = {
"_edit_use_anchors_": false
}

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
stream = ExtResource( 15 )
autoplay = true
